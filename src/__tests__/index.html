<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Elemento test page</title>
    <script type="importmap">
        {
            "imports": {
        "Elemento": "../../dist/index.js"
            }
        }
    </script>
</head>
<body>
<script type="module">
    import {BoolAttr, Elemento, signal, computed, html, mount, unmount} from 'Elemento';

    // Define the list of reactive custom element attributes
    const attributes = [
        'variant',
        'state',
        'loading',
        'shape',
        'inverted',
        'aria-expanded',
        'extended',
        'extended--mobile',
        'extended--tablet',
        'extended--laptop',
    ];

    const properties = [
        'data'
    ]

    let j = 0;

    const Button = ({variant, shape, inverted, extended, loading, data, ...rest}) => {
        // Create internal state using signals
        const state = signal(0)
        const state2 = signal(0)
        const state3 = computed(() => state.value + state2.value)

        // Create computed values based on either internal state or custom element attributes
        const computedStyle = computed(() =>
            [
                variant.value || 'btn',
                shape.value || 'default',
                BoolAttr(inverted.value) ? 'inverted' : '',
                BoolAttr(loading.value) ? 'loading' : '',
            ].join(' ')
        );

        // Define effects to run when the component is mounted or unmounted
        mount(() => console.log('Mounted!'));
        unmount(() => console.log('Unmounted!'));

        return html`
            <button
                    class="${computedStyle.value}"
                    aria-expanded="${rest['aria-expanded'].value}"
                    @click=${() => {
                        //counter.value++;
                        if (j++ % 2 === 0) {
                            state2.value++;
                            return;
                        }
                        state.value++;
                    }}
            >
                <slot></slot>
                <span>Counter: ${variant.value} ${state.value} ${state2.value} ${state3.value} ${data.value?.name}</span>
            </button>`;
    };

    // Register the custom element with Elemento
    customElements.define(
        'my-button',
        Elemento(Button, { observedAttributes: attributes, properties })
    );
    // For TypeScript, you can type the options:
    // import type { ElementoOptions } from '@solidx/elemento';
    // const opts: ElementoOptions<typeof attributes[number], typeof properties[number]> = { observedAttributes: attributes, properties };

    customElements.define(
        'my-data-button',
        Elemento(() => {
            return html`
                <my-button .data=${{name: 'Damien'}}>
                    <slot></slot>
                </my-button>`;
        })
    )
</script>
<my-data-button>Tap me</my-data-button>
</body>
</html>
